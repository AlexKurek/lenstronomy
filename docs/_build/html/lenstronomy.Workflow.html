
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>lenstronomy.Workflow package &#8212; lenstronomy 1.9.3 documentation</title>
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Contributing to lenstronomy" href="contributing.html" />
    <link rel="prev" title="lenstronomy.Util package" href="lenstronomy.Util.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="contributing.html" title="Contributing to lenstronomy"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="lenstronomy.Util.html" title="lenstronomy.Util package"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">lenstronomy 1.9.3 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="lenstronomy.html" accesskey="U">lenstronomy package</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">lenstronomy.Workflow package</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="lenstronomy-workflow-package">
<h1>lenstronomy.Workflow package<a class="headerlink" href="#lenstronomy-workflow-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-lenstronomy.Workflow.alignment_matching">
<span id="lenstronomy-workflow-alignment-matching-module"></span><h2>lenstronomy.Workflow.alignment_matching module<a class="headerlink" href="#module-lenstronomy.Workflow.alignment_matching" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="lenstronomy.Workflow.alignment_matching.AlignmentFitting">
<em class="property">class </em><code class="sig-prename descclassname">lenstronomy.Workflow.alignment_matching.</code><code class="sig-name descname">AlignmentFitting</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">multi_band_list</span></em>, <em class="sig-param"><span class="n">kwargs_model</span></em>, <em class="sig-param"><span class="n">kwargs_params</span></em>, <em class="sig-param"><span class="n">band_index</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">likelihood_mask_list</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/Workflow/alignment_matching.html#AlignmentFitting"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lenstronomy.Workflow.alignment_matching.AlignmentFitting" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>class which executes the different sampling  methods</p>
<dl class="py method">
<dt id="lenstronomy.Workflow.alignment_matching.AlignmentFitting.pso">
<code class="sig-name descname">pso</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">n_particles</span><span class="o">=</span><span class="default_value">10</span></em>, <em class="sig-param"><span class="n">n_iterations</span><span class="o">=</span><span class="default_value">10</span></em>, <em class="sig-param"><span class="n">lowerLimit</span><span class="o">=</span><span class="default_value">- 0.2</span></em>, <em class="sig-param"><span class="n">upperLimit</span><span class="o">=</span><span class="default_value">0.2</span></em>, <em class="sig-param"><span class="n">threadCount</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">mpi</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">print_key</span><span class="o">=</span><span class="default_value">'default'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/Workflow/alignment_matching.html#AlignmentFitting.pso"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lenstronomy.Workflow.alignment_matching.AlignmentFitting.pso" title="Permalink to this definition">¶</a></dt>
<dd><p>returns the best fit for the lense model on catalogue basis with particle swarm optimizer</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="lenstronomy.Workflow.alignment_matching.AlignmentLikelihood">
<em class="property">class </em><code class="sig-prename descclassname">lenstronomy.Workflow.alignment_matching.</code><code class="sig-name descname">AlignmentLikelihood</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">multi_band_list</span></em>, <em class="sig-param"><span class="n">kwargs_model</span></em>, <em class="sig-param"><span class="n">kwargs_params</span></em>, <em class="sig-param"><span class="n">band_index</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">likelihood_mask_list</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/Workflow/alignment_matching.html#AlignmentLikelihood"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lenstronomy.Workflow.alignment_matching.AlignmentLikelihood" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt id="lenstronomy.Workflow.alignment_matching.AlignmentLikelihood.computeLikelihood">
<code class="sig-name descname">computeLikelihood</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ctx</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/Workflow/alignment_matching.html#AlignmentLikelihood.computeLikelihood"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lenstronomy.Workflow.alignment_matching.AlignmentLikelihood.computeLikelihood" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="lenstronomy.Workflow.alignment_matching.AlignmentLikelihood.get_args">
<em class="property">static </em><code class="sig-name descname">get_args</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">kwargs_data</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/Workflow/alignment_matching.html#AlignmentLikelihood.get_args"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lenstronomy.Workflow.alignment_matching.AlignmentLikelihood.get_args" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kwargs_data</strong> – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lenstronomy.Workflow.alignment_matching.AlignmentLikelihood.likelihood">
<code class="sig-name descname">likelihood</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">a</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/Workflow/alignment_matching.html#AlignmentLikelihood.likelihood"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lenstronomy.Workflow.alignment_matching.AlignmentLikelihood.likelihood" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="lenstronomy.Workflow.alignment_matching.AlignmentLikelihood.num_param">
<em class="property">property </em><code class="sig-name descname">num_param</code><a class="headerlink" href="#lenstronomy.Workflow.alignment_matching.AlignmentLikelihood.num_param" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="lenstronomy.Workflow.alignment_matching.AlignmentLikelihood.setup">
<code class="sig-name descname">setup</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/Workflow/alignment_matching.html#AlignmentLikelihood.setup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lenstronomy.Workflow.alignment_matching.AlignmentLikelihood.setup" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="lenstronomy.Workflow.alignment_matching.AlignmentLikelihood.update_data">
<code class="sig-name descname">update_data</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">args</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/Workflow/alignment_matching.html#AlignmentLikelihood.update_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lenstronomy.Workflow.alignment_matching.AlignmentLikelihood.update_data" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>args</strong> – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lenstronomy.Workflow.alignment_matching.AlignmentLikelihood.update_multi_band">
<code class="sig-name descname">update_multi_band</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">args</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/Workflow/alignment_matching.html#AlignmentLikelihood.update_multi_band"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lenstronomy.Workflow.alignment_matching.AlignmentLikelihood.update_multi_band" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>args</strong> – list of parameters</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>updated multi_band_list</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-lenstronomy.Workflow.fitting_sequence">
<span id="lenstronomy-workflow-fitting-sequence-module"></span><h2>lenstronomy.Workflow.fitting_sequence module<a class="headerlink" href="#module-lenstronomy.Workflow.fitting_sequence" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="lenstronomy.Workflow.fitting_sequence.FittingSequence">
<em class="property">class </em><code class="sig-prename descclassname">lenstronomy.Workflow.fitting_sequence.</code><code class="sig-name descname">FittingSequence</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">kwargs_data_joint</span></em>, <em class="sig-param"><span class="n">kwargs_model</span></em>, <em class="sig-param"><span class="n">kwargs_constraints</span></em>, <em class="sig-param"><span class="n">kwargs_likelihood</span></em>, <em class="sig-param"><span class="n">kwargs_params</span></em>, <em class="sig-param"><span class="n">mpi</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/Workflow/fitting_sequence.html#FittingSequence"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lenstronomy.Workflow.fitting_sequence.FittingSequence" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>class to define a sequence of fitting applied, inherit the Fitting class
this is a Workflow manager that allows to update model configurations before executing another step in the modelling
The user can take this module as an example of how to create their own workflows or build their own around the FittingSequence</p>
<dl class="py method">
<dt id="lenstronomy.Workflow.fitting_sequence.FittingSequence.align_images">
<code class="sig-name descname">align_images</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">n_particles</span><span class="o">=</span><span class="default_value">10</span></em>, <em class="sig-param"><span class="n">n_iterations</span><span class="o">=</span><span class="default_value">10</span></em>, <em class="sig-param"><span class="n">lowerLimit</span><span class="o">=</span><span class="default_value">- 0.2</span></em>, <em class="sig-param"><span class="n">upperLimit</span><span class="o">=</span><span class="default_value">0.2</span></em>, <em class="sig-param"><span class="n">threadCount</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">compute_bands</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/Workflow/fitting_sequence.html#FittingSequence.align_images"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lenstronomy.Workflow.fitting_sequence.FittingSequence.align_images" title="Permalink to this definition">¶</a></dt>
<dd><p>aligns the coordinate systems of different exposures within a fixed model parameterisation by executing a PSO
with relative coordinate shifts as free parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_particles</strong> – number of particles in the Particle Swarm Optimization</p></li>
<li><p><strong>n_iterations</strong> – number of iterations in the optimization process</p></li>
<li><p><strong>lowerLimit</strong> – lower limit of relative shift</p></li>
<li><p><strong>upperLimit</strong> – upper limit of relative shift</p></li>
<li><p><strong>compute_bands</strong> – bool list, if multiple bands, this process can be limited to a subset of bands</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>0, updated coordinate system for the band(s)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lenstronomy.Workflow.fitting_sequence.FittingSequence.best_fit">
<code class="sig-name descname">best_fit</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">bijective</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/Workflow/fitting_sequence.html#FittingSequence.best_fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lenstronomy.Workflow.fitting_sequence.FittingSequence.best_fit" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>bijective</strong> – bool, if True, the mapping of image2source_plane and the mass_scaling parameterisation are inverted. If you do not use those options, there is no effect.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>best fit model of the current state of the FittingSequence class</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lenstronomy.Workflow.fitting_sequence.FittingSequence.best_fit_likelihood">
<em class="property">property </em><code class="sig-name descname">best_fit_likelihood</code><a class="headerlink" href="#lenstronomy.Workflow.fitting_sequence.FittingSequence.best_fit_likelihood" title="Permalink to this definition">¶</a></dt>
<dd><p>returns the log likelihood of the best fit model of the current state of this class</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>log likelihood, float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lenstronomy.Workflow.fitting_sequence.FittingSequence.bic">
<em class="property">property </em><code class="sig-name descname">bic</code><a class="headerlink" href="#lenstronomy.Workflow.fitting_sequence.FittingSequence.bic" title="Permalink to this definition">¶</a></dt>
<dd><p>returns the bayesian information criterion of the model.
:return: bic value, float</p>
</dd></dl>

<dl class="py method">
<dt id="lenstronomy.Workflow.fitting_sequence.FittingSequence.fit_sequence">
<code class="sig-name descname">fit_sequence</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fitting_list</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/Workflow/fitting_sequence.html#FittingSequence.fit_sequence"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lenstronomy.Workflow.fitting_sequence.FittingSequence.fit_sequence" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>fitting_list</strong> – list of [[‘string’, {kwargs}], ..] with ‘string being the specific fitting option and
kwargs being the arguments passed to this option</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>fitting results</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lenstronomy.Workflow.fitting_sequence.FittingSequence.fix_not_computed">
<code class="sig-name descname">fix_not_computed</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">free_bands</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/Workflow/fitting_sequence.html#FittingSequence.fix_not_computed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lenstronomy.Workflow.fitting_sequence.FittingSequence.fix_not_computed" title="Permalink to this definition">¶</a></dt>
<dd><p>fixes lens model parameters of imaging bands/frames that are not computed and frees the parameters of the other
lens models to the initial kwargs_fixed options</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>free_bands</strong> – bool list of length of imaging bands in order of imaging bands, if False: set fixed lens model</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lenstronomy.Workflow.fitting_sequence.FittingSequence.kwargs_fixed">
<code class="sig-name descname">kwargs_fixed</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/Workflow/fitting_sequence.html#FittingSequence.kwargs_fixed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lenstronomy.Workflow.fitting_sequence.FittingSequence.kwargs_fixed" title="Permalink to this definition">¶</a></dt>
<dd><p>returns the updated kwargs_fixed from the update Manager</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>list of fixed kwargs, see UpdateManager()</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lenstronomy.Workflow.fitting_sequence.FittingSequence.likelihoodModule">
<em class="property">property </em><code class="sig-name descname">likelihoodModule</code><a class="headerlink" href="#lenstronomy.Workflow.fitting_sequence.FittingSequence.likelihoodModule" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Likelihood() class instance reflecting the current state of FittingSequence</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lenstronomy.Workflow.fitting_sequence.FittingSequence.mcmc">
<code class="sig-name descname">mcmc</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">n_burn</span></em>, <em class="sig-param"><span class="n">n_run</span></em>, <em class="sig-param"><span class="n">walkerRatio</span></em>, <em class="sig-param"><span class="n">n_walkers</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">sigma_scale</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">threadCount</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">init_samples</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">re_use_samples</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">sampler_type</span><span class="o">=</span><span class="default_value">'EMCEE'</span></em>, <em class="sig-param"><span class="n">progress</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">backup_filename</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">start_from_backup</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/Workflow/fitting_sequence.html#FittingSequence.mcmc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lenstronomy.Workflow.fitting_sequence.FittingSequence.mcmc" title="Permalink to this definition">¶</a></dt>
<dd><p>MCMC routine</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_burn</strong> – number of burn in iterations (will not be saved)</p></li>
<li><p><strong>n_run</strong> – number of MCMC iterations that are saved</p></li>
<li><p><strong>walkerRatio</strong> – ratio of walkers/number of free parameters</p></li>
<li><p><strong>n_walkers</strong> – integer, number of walkers of emcee (optional, if set, overwrites the walkerRatio input</p></li>
<li><p><strong>sigma_scale</strong> – scaling of the initial parameter spread relative to the width in the initial settings</p></li>
<li><p><strong>threadCount</strong> – number of CPU threads. If MPI option is set, threadCount=1</p></li>
<li><p><strong>init_samples</strong> – initial sample from where to start the MCMC process</p></li>
<li><p><strong>re_use_samples</strong> – bool, if True, re-uses the samples described in init_samples.nOtherwise starts from scratch.</p></li>
<li><p><strong>sampler_type</strong> – string, which MCMC sampler to be used. Options are: ‘EMCEE’</p></li>
<li><p><strong>progress</strong> – boolean, if True shows progress bar in EMCEE</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of output arguments, e.g. MCMC samples, parameter names, logL distances of all samples specified by the specific sampler used</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lenstronomy.Workflow.fitting_sequence.FittingSequence.nested_sampling">
<code class="sig-name descname">nested_sampling</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sampler_type</span><span class="o">=</span><span class="default_value">'MULTINEST'</span></em>, <em class="sig-param"><span class="n">kwargs_run</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">prior_type</span><span class="o">=</span><span class="default_value">'uniform'</span></em>, <em class="sig-param"><span class="n">width_scale</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">sigma_scale</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">output_basename</span><span class="o">=</span><span class="default_value">'chain'</span></em>, <em class="sig-param"><span class="n">remove_output_dir</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">dypolychord_dynamic_goal</span><span class="o">=</span><span class="default_value">0.8</span></em>, <em class="sig-param"><span class="n">polychord_settings</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">dypolychord_seed_increment</span><span class="o">=</span><span class="default_value">200</span></em>, <em class="sig-param"><span class="n">output_dir</span><span class="o">=</span><span class="default_value">'nested_sampling_chains'</span></em>, <em class="sig-param"><span class="n">dynesty_bound</span><span class="o">=</span><span class="default_value">'multi'</span></em>, <em class="sig-param"><span class="n">dynesty_sample</span><span class="o">=</span><span class="default_value">'auto'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/Workflow/fitting_sequence.html#FittingSequence.nested_sampling"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lenstronomy.Workflow.fitting_sequence.FittingSequence.nested_sampling" title="Permalink to this definition">¶</a></dt>
<dd><p>Run (Dynamic) Nested Sampling algorithms, depending on the type of algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sampler_type</strong> – ‘MULTINEST’, ‘DYPOLYCHORD’, ‘DYNESTY’</p></li>
<li><p><strong>kwargs_run</strong> – keywords passed to the core sampling method</p></li>
<li><p><strong>prior_type</strong> – ‘uniform’ of ‘gaussian’, for converting the unit hypercube to param cube</p></li>
<li><p><strong>width_scale</strong> – scale the width (lower/upper limits) of the parameters space by this factor</p></li>
<li><p><strong>sigma_scale</strong> – if prior_type is ‘gaussian’, scale the gaussian sigma by this factor</p></li>
<li><p><strong>output_basename</strong> – name of the folder in which the core MultiNest/PolyChord code will save output files</p></li>
<li><p><strong>remove_output_dir</strong> – if True, the above folder is removed after completion</p></li>
<li><p><strong>dypolychord_dynamic_goal</strong> – dynamic goal for DyPolyChord (trade-off between evidence (0) and posterior (1) computation)</p></li>
<li><p><strong>polychord_settings</strong> – settings dictionary to send to pypolychord. Check dypolychord documentation for details.</p></li>
<li><p><strong>dypolychord_seed_increment</strong> – seed increment for dypolychord with MPI. Check dypolychord documentation for details.</p></li>
<li><p><strong>dynesty_bound</strong> – see <a class="reference external" href="https://dynesty.readthedocs.io">https://dynesty.readthedocs.io</a> for details</p></li>
<li><p><strong>dynesty_sample</strong> – see <a class="reference external" href="https://dynesty.readthedocs.io">https://dynesty.readthedocs.io</a> for details</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of output arguments : samples, mean inferred values, log-likelihood, log-evidence, error on log-evidence for each sample</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lenstronomy.Workflow.fitting_sequence.FittingSequence.param_class">
<em class="property">property </em><code class="sig-name descname">param_class</code><a class="headerlink" href="#lenstronomy.Workflow.fitting_sequence.FittingSequence.param_class" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Param() class instance reflecting the current state of FittingSequence</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lenstronomy.Workflow.fitting_sequence.FittingSequence.psf_iteration">
<code class="sig-name descname">psf_iteration</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">compute_bands</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs_psf_iter</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/Workflow/fitting_sequence.html#FittingSequence.psf_iteration"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lenstronomy.Workflow.fitting_sequence.FittingSequence.psf_iteration" title="Permalink to this definition">¶</a></dt>
<dd><p>iterative PSF reconstruction</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>compute_bands</strong> – bool list, if multiple bands, this process can be limited to a subset of bands</p></li>
<li><p><strong>kwargs_psf_iter</strong> – keyword arguments as used or available in PSFIteration.update_iterative() definition</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>0, updated PSF is stored in self.multi_band_list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lenstronomy.Workflow.fitting_sequence.FittingSequence.pso">
<code class="sig-name descname">pso</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">n_particles</span></em>, <em class="sig-param"><span class="n">n_iterations</span></em>, <em class="sig-param"><span class="n">sigma_scale</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">print_key</span><span class="o">=</span><span class="default_value">'PSO'</span></em>, <em class="sig-param"><span class="n">threadCount</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/Workflow/fitting_sequence.html#FittingSequence.pso"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lenstronomy.Workflow.fitting_sequence.FittingSequence.pso" title="Permalink to this definition">¶</a></dt>
<dd><p>Particle Swarm Optimization</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_particles</strong> – number of particles in the Particle Swarm Optimization</p></li>
<li><p><strong>n_iterations</strong> – number of iterations in the optimization process</p></li>
<li><p><strong>sigma_scale</strong> – scaling of the initial parameter spread relative to the width in the initial settings</p></li>
<li><p><strong>print_key</strong> – string, printed text when executing this routine</p></li>
<li><p><strong>threadCount</strong> – number of CPU threads. If MPI option is set, threadCount=1</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>result of the best fit, the chain of the best fit parameter after each iteration, list of parameters in same order</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lenstronomy.Workflow.fitting_sequence.FittingSequence.set_param_value">
<code class="sig-name descname">set_param_value</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/Workflow/fitting_sequence.html#FittingSequence.set_param_value"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lenstronomy.Workflow.fitting_sequence.FittingSequence.set_param_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Set a parameter to a specific value. <cite>kwargs</cite> are below.
:param lens: [[i_model, [‘param1’, ‘param2’,…], […]]
:type lens:
:param source: [[i_model, [‘param1’, ‘param2’,…], […]]
:type source:
:param lens_light: [[i_model, [‘param1’, ‘param2’,…], […]]
:type lens_light:
:param ps: [[i_model, [‘param1’, ‘param2’,…], […]]
:type ps:
:return: 0, the value of the param is overwritten
:rtype:</p>
</dd></dl>

<dl class="py method">
<dt id="lenstronomy.Workflow.fitting_sequence.FittingSequence.simplex">
<code class="sig-name descname">simplex</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">n_iterations</span></em>, <em class="sig-param"><span class="n">method</span><span class="o">=</span><span class="default_value">'Nelder-Mead'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/Workflow/fitting_sequence.html#FittingSequence.simplex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lenstronomy.Workflow.fitting_sequence.FittingSequence.simplex" title="Permalink to this definition">¶</a></dt>
<dd><p>Downhill simplex optimization using the Nelder-Mead algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_iterations</strong> – maximum number of iterations to perform</p></li>
<li><p><strong>method</strong> – the optimization method used, see documentation in scipy.optimize.minimize</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>result of the best fit</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lenstronomy.Workflow.fitting_sequence.FittingSequence.update_settings">
<code class="sig-name descname">update_settings</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">kwargs_model</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">kwargs_constraints</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">kwargs_likelihood</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">lens_add_fixed</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">source_add_fixed</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">lens_light_add_fixed</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">ps_add_fixed</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">cosmo_add_fixed</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">lens_remove_fixed</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">source_remove_fixed</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">lens_light_remove_fixed</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">ps_remove_fixed</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">cosmo_remove_fixed</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">change_source_lower_limit</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">change_source_upper_limit</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">change_lens_lower_limit</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">change_lens_upper_limit</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/Workflow/fitting_sequence.html#FittingSequence.update_settings"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lenstronomy.Workflow.fitting_sequence.FittingSequence.update_settings" title="Permalink to this definition">¶</a></dt>
<dd><p>updates lenstronomy settings “on the fly”</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kwargs_model</strong> – kwargs, specified keyword arguments overwrite the existing ones</p></li>
<li><p><strong>kwargs_constraints</strong> – kwargs, specified keyword arguments overwrite the existing ones</p></li>
<li><p><strong>kwargs_likelihood</strong> – kwargs, specified keyword arguments overwrite the existing ones</p></li>
<li><p><strong>lens_add_fixed</strong> – [[i_model, [‘param1’, ‘param2’,…], […]]</p></li>
<li><p><strong>source_add_fixed</strong> – [[i_model, [‘param1’, ‘param2’,…], […]]</p></li>
<li><p><strong>lens_light_add_fixed</strong> – [[i_model, [‘param1’, ‘param2’,…], […]]</p></li>
<li><p><strong>ps_add_fixed</strong> – [[i_model, [‘param1’, ‘param2’,…], […]]</p></li>
<li><p><strong>cosmo_add_fixed</strong> – [‘param1’, ‘param2’,…]</p></li>
<li><p><strong>lens_remove_fixed</strong> – [[i_model, [‘param1’, ‘param2’,…], […]]</p></li>
<li><p><strong>source_remove_fixed</strong> – [[i_model, [‘param1’, ‘param2’,…], […]]</p></li>
<li><p><strong>lens_light_remove_fixed</strong> – [[i_model, [‘param1’, ‘param2’,…], […]]</p></li>
<li><p><strong>ps_remove_fixed</strong> – [[i_model, [‘param1’, ‘param2’,…], […]]</p></li>
<li><p><strong>cosmo_remove_fixed</strong> – [‘param1’, ‘param2’,…]</p></li>
<li><p><strong>change_lens_lower_limit</strong> – [[i_model, [‘param_name’, …], [value1, value2, …]]]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>0, the settings are overwritten for the next fitting step to come</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lenstronomy.Workflow.fitting_sequence.FittingSequence.update_state">
<code class="sig-name descname">update_state</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">kwargs_update</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/Workflow/fitting_sequence.html#FittingSequence.update_state"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lenstronomy.Workflow.fitting_sequence.FittingSequence.update_state" title="Permalink to this definition">¶</a></dt>
<dd><p>updates current best fit state to the input model keywords specified.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kwargs_update</strong> – format of kwargs_result</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-lenstronomy.Workflow.psf_fitting">
<span id="lenstronomy-workflow-psf-fitting-module"></span><h2>lenstronomy.Workflow.psf_fitting module<a class="headerlink" href="#module-lenstronomy.Workflow.psf_fitting" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="lenstronomy.Workflow.psf_fitting.PsfFitting">
<em class="property">class </em><code class="sig-prename descclassname">lenstronomy.Workflow.psf_fitting.</code><code class="sig-name descname">PsfFitting</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">image_model_class</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/Workflow/psf_fitting.html#PsfFitting"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lenstronomy.Workflow.psf_fitting.PsfFitting" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>class to find subsequently a better psf
The method make use of a model and subtracts all the non-point source components of the model from the data.
If the model is sufficient, then the data will be a (better) representation of the actual PSF. The method cuts out
those point sources and combines them to update the estimate of the PSF. This is done in an iterative procedure as
the model components of the extended features is PSF-dependent (hopefully not too much).</p>
<p>Various options can be chosen. There is no guarantee that the method works for specific data and models.</p>
<dl class="simple">
<dt>‘stacking_method’: ‘median’, ‘mean’; the different estimates of the PSF are stacked and combined together. The choices are:</dt><dd><p>‘mean’: mean of pixel values as the estimator (not robust to outliers)
‘median’: median of pixel values as the estimator (outlier rejection robust but needs &gt;2 point sources in the data</p>
</dd>
<dt>‘block_center_neighbour’: angle, radius of neighbouring point sources around their centers the estimates is ignored.</dt><dd><p>Default is zero, meaning a not optimal subtraction of the neighbouring point sources might contaminate the estimate.</p>
</dd>
<dt>‘keep_error_map’: bool, if True, does not replace the error term associated with the PSF estimate.</dt><dd><p>If false, re-estimates the variance between the PSF estimates.</p>
</dd>
<dt>‘psf_symmetry’: number of rotational invariant symmetries in the estimated PSF.</dt><dd><p>=1 mean no additional symmetries. =4 means 90 deg symmetry. This is enforced by a rotatioanl stack according to
the symmetry specified. These additional imposed symmetries can help stabelize the PSF estimate when there are
limited constraints/number of point sources in the image.</p>
</dd>
</dl>
<p>The procedure only requires and changes the ‘point_source_kernel’ in the PSF() class and the ‘psf_error_map’.
Any previously set subgrid kernels or pixel_kernels are removed and constructed from the ‘point_source_kernel’.</p>
<dl class="py method">
<dt id="lenstronomy.Workflow.psf_fitting.PsfFitting.combine_psf">
<em class="property">static </em><code class="sig-name descname">combine_psf</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">kernel_list_new</span></em>, <em class="sig-param"><span class="n">kernel_old</span></em>, <em class="sig-param"><span class="n">factor</span><span class="o">=</span><span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">stacking_option</span><span class="o">=</span><span class="default_value">'median'</span></em>, <em class="sig-param"><span class="n">symmetry</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/Workflow/psf_fitting.html#PsfFitting.combine_psf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lenstronomy.Workflow.psf_fitting.PsfFitting.combine_psf" title="Permalink to this definition">¶</a></dt>
<dd><p>updates psf estimate based on old kernel and several new estimates
:param kernel_list_new: list of new PSF kernels estimated from the point sources in the image (un-normalized)
:param kernel_old: old PSF kernel
:param factor: weight of updated estimate based on new and old estimate, factor=1 means new estimate,
factor=0 means old estimate
:param stacking_option: option of stacking, mean or median
:param symmetry: imposed symmetry of PSF estimate
:return: updated PSF estimate and error_map associated with it</p>
</dd></dl>

<dl class="py method">
<dt id="lenstronomy.Workflow.psf_fitting.PsfFitting.cutout_psf">
<code class="sig-name descname">cutout_psf</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ra_image</span></em>, <em class="sig-param"><span class="n">dec_image</span></em>, <em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">y</span></em>, <em class="sig-param"><span class="n">image_list</span></em>, <em class="sig-param"><span class="n">kernel_size</span></em>, <em class="sig-param"><span class="n">kernel_init</span></em>, <em class="sig-param"><span class="n">block_center_neighbour</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/Workflow/psf_fitting.html#PsfFitting.cutout_psf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lenstronomy.Workflow.psf_fitting.PsfFitting.cutout_psf" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ra_image</strong> – coordinate array of images in angles</p></li>
<li><p><strong>dec_image</strong> – coordinate array of images in angles</p></li>
<li><p><strong>x</strong> – image position array in x-pixel</p></li>
<li><p><strong>y</strong> – image position array in y-pixel</p></li>
<li><p><strong>image_list</strong> – list of images (i.e. data - all models subtracted, except a single point source)</p></li>
<li><p><strong>kernel_size</strong> – width in pixel of the kernel</p></li>
<li><p><strong>kernel_init</strong> – initial guess of kernel (pixels that are masked are replaced by those values)</p></li>
<li><p><strong>block_center_neighbour</strong> – angle, radius of neighbouring point sources around their centers the estimates
is ignored. Default is zero, meaning a not optimal subtraction of the neighbouring point sources might
contaminate the estimate.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of de-shifted kernel estimates</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lenstronomy.Workflow.psf_fitting.PsfFitting.cutout_psf_single">
<em class="property">static </em><code class="sig-name descname">cutout_psf_single</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">y</span></em>, <em class="sig-param"><span class="n">image</span></em>, <em class="sig-param"><span class="n">mask</span></em>, <em class="sig-param"><span class="n">kernel_size</span></em>, <em class="sig-param"><span class="n">kernel_init</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/Workflow/psf_fitting.html#PsfFitting.cutout_psf_single"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lenstronomy.Workflow.psf_fitting.PsfFitting.cutout_psf_single" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – x-coordinate of point source</p></li>
<li><p><strong>y</strong> – y-coordinate of point source</p></li>
<li><p><strong>image</strong> – image (i.e. data - all models subtracted, except a single point source)</p></li>
<li><p><strong>mask</strong> – mask of pixels in the image not to be considered in the PSF estimate (being replaced by kernel_init)</p></li>
<li><p><strong>kernel_size</strong> – width in pixel of the kernel</p></li>
<li><p><strong>kernel_init</strong> – initial guess of kernel (pixels that are masked are replaced by those values)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>estimate of the PSF based on the image and position of the point source</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lenstronomy.Workflow.psf_fitting.PsfFitting.error_map_estimate">
<code class="sig-name descname">error_map_estimate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">kernel</span></em>, <em class="sig-param"><span class="n">star_cutout_list</span></em>, <em class="sig-param"><span class="n">amp</span></em>, <em class="sig-param"><span class="n">x_pos</span></em>, <em class="sig-param"><span class="n">y_pos</span></em>, <em class="sig-param"><span class="n">error_map_radius</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">block_center_neighbour</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/Workflow/psf_fitting.html#PsfFitting.error_map_estimate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lenstronomy.Workflow.psf_fitting.PsfFitting.error_map_estimate" title="Permalink to this definition">¶</a></dt>
<dd><p>provides a psf_error_map based on the goodness of fit of the given PSF kernel on the point source cutouts,
their estimated amplitudes and positions</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kernel</strong> – PSF kernel</p></li>
<li><p><strong>star_cutout_list</strong> – list of 2d arrays of cutouts of the point sources with all other model components subtracted</p></li>
<li><p><strong>amp</strong> – list of amplitudes of the estimated PSF kernel</p></li>
<li><p><strong>x_pos</strong> – pixel position (in original data unit, not in cutout) of the point sources (same order as amp and star cutouts)</p></li>
<li><p><strong>y_pos</strong> – pixel position (in original data unit, not in cutout) of the point sources (same order as amp and star cutouts)</p></li>
<li><p><strong>error_map_radius</strong> – float, radius (in arc seconds) of the outermost error in the PSF estimate (e.g. to avoid double counting of overlapping PSF erros)</p></li>
<li><p><strong>block_center_neighbour</strong> – angle, radius of neighbouring point sources around their centers the estimates
is ignored. Default is zero, meaning a not optimal subtraction of the neighbouring point sources might
contaminate the estimate.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>relative uncertainty in the psf model (in quadrature) per pixel based on residuals achieved in the image</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lenstronomy.Workflow.psf_fitting.PsfFitting.error_map_estimate_new">
<code class="sig-name descname">error_map_estimate_new</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">psf_kernel</span></em>, <em class="sig-param"><span class="n">psf_kernel_list</span></em>, <em class="sig-param"><span class="n">ra_image</span></em>, <em class="sig-param"><span class="n">dec_image</span></em>, <em class="sig-param"><span class="n">point_amp</span></em>, <em class="sig-param"><span class="n">supersampling_factor</span></em>, <em class="sig-param"><span class="n">error_map_radius</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/Workflow/psf_fitting.html#PsfFitting.error_map_estimate_new"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lenstronomy.Workflow.psf_fitting.PsfFitting.error_map_estimate_new" title="Permalink to this definition">¶</a></dt>
<dd><p>relative uncertainty in the psf model (in quadrature) per pixel based on residuals achieved in the image</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>psf_kernel</strong> – PSF kernel (super-sampled)</p></li>
<li><p><strong>psf_kernel_list</strong> – list of individual best PSF kernel estimates</p></li>
<li><p><strong>ra_image</strong> – image positions in angles</p></li>
<li><p><strong>dec_image</strong> – image positions in angles</p></li>
<li><p><strong>point_amp</strong> – image amplitude</p></li>
<li><p><strong>supersampling_factor</strong> – super-sampling factor</p></li>
<li><p><strong>error_map_radius</strong> – radius (in angle) to cut the error map</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>psf error map such that square of the uncertainty gets boosted by error_map * (psf * amp)**2</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lenstronomy.Workflow.psf_fitting.PsfFitting.image_single_point_source">
<code class="sig-name descname">image_single_point_source</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">image_model_class</span></em>, <em class="sig-param"><span class="n">kwargs_params</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/Workflow/psf_fitting.html#PsfFitting.image_single_point_source"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lenstronomy.Workflow.psf_fitting.PsfFitting.image_single_point_source" title="Permalink to this definition">¶</a></dt>
<dd><p>return model without including the point source contributions as a list (for each point source individually)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image_model_class</strong> – ImageModel class instance</p></li>
<li><p><strong>kwargs_params</strong> – keyword arguments of model component keyword argument lists</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of images with point source isolated</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lenstronomy.Workflow.psf_fitting.PsfFitting.mask_point_source">
<em class="property">static </em><code class="sig-name descname">mask_point_source</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x_pos</span></em>, <em class="sig-param"><span class="n">y_pos</span></em>, <em class="sig-param"><span class="n">x_grid</span></em>, <em class="sig-param"><span class="n">y_grid</span></em>, <em class="sig-param"><span class="n">radius</span></em>, <em class="sig-param"><span class="n">i</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/Workflow/psf_fitting.html#PsfFitting.mask_point_source"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lenstronomy.Workflow.psf_fitting.PsfFitting.mask_point_source" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_pos</strong> – x-position of list of point sources</p></li>
<li><p><strong>y_pos</strong> – y-position of list of point sources</p></li>
<li><p><strong>x_grid</strong> – x-coordinates of grid</p></li>
<li><p><strong>y_grid</strong> – y-coordinates of grid</p></li>
<li><p><strong>i</strong> – index of point source not to mask out</p></li>
<li><p><strong>radius</strong> – radius to mask out other point sources</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a mask of the size of the image with cutouts around the position</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lenstronomy.Workflow.psf_fitting.PsfFitting.point_like_source_cutouts">
<em class="property">static </em><code class="sig-name descname">point_like_source_cutouts</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x_pos</span></em>, <em class="sig-param"><span class="n">y_pos</span></em>, <em class="sig-param"><span class="n">image_list</span></em>, <em class="sig-param"><span class="n">cutout_size</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/Workflow/psf_fitting.html#PsfFitting.point_like_source_cutouts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lenstronomy.Workflow.psf_fitting.PsfFitting.point_like_source_cutouts" title="Permalink to this definition">¶</a></dt>
<dd><p>cutouts of point-like objects</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_pos</strong> – list of image positions in pixel units</p></li>
<li><p><strong>y_pos</strong> – list of image position in pixel units</p></li>
<li><p><strong>image_list</strong> – list of 2d numpy arrays with cleaned images, with all contaminating sources removed except
the point-like object to be cut out.</p></li>
<li><p><strong>cutout_size</strong> – odd integer, size of cutout.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of cutouts</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lenstronomy.Workflow.psf_fitting.PsfFitting.psf_estimate_individual">
<code class="sig-name descname">psf_estimate_individual</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ra_image</span></em>, <em class="sig-param"><span class="n">dec_image</span></em>, <em class="sig-param"><span class="n">point_amp</span></em>, <em class="sig-param"><span class="n">residuals</span></em>, <em class="sig-param"><span class="n">cutout_size</span></em>, <em class="sig-param"><span class="n">kernel_guess</span></em>, <em class="sig-param"><span class="n">supersampling_factor</span></em>, <em class="sig-param"><span class="n">block_center_neighbour</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/Workflow/psf_fitting.html#PsfFitting.psf_estimate_individual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lenstronomy.Workflow.psf_fitting.PsfFitting.psf_estimate_individual" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ra_image</strong> – list; position in angular units of the image</p></li>
<li><p><strong>dec_image</strong> – list; position in angular units of the image</p></li>
<li><p><strong>point_amp</strong> – list of model amplitudes of point sources</p></li>
<li><p><strong>residuals</strong> – data - model</p></li>
<li><p><strong>cutout_size</strong> – pixel size of cutout around single star/quasar to be considered for the psf reconstruction</p></li>
<li><p><strong>kernel_guess</strong> – initial guess of super-sampled PSF</p></li>
<li><p><strong>supersampling_factor</strong> – int, super-sampling factor</p></li>
<li><p><strong>block_center_neighbour</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of best-guess PSF’s for each star based on the residual patterns</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lenstronomy.Workflow.psf_fitting.PsfFitting.update_iterative">
<code class="sig-name descname">update_iterative</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">kwargs_psf</span></em>, <em class="sig-param"><span class="n">kwargs_params</span></em>, <em class="sig-param"><span class="n">num_iter</span><span class="o">=</span><span class="default_value">10</span></em>, <em class="sig-param"><span class="n">keep_psf_error_map</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">no_break</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs_psf_update</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/Workflow/psf_fitting.html#PsfFitting.update_iterative"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lenstronomy.Workflow.psf_fitting.PsfFitting.update_iterative" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kwargs_psf</strong> – keyword arguments to construct the PSF() class</p></li>
<li><p><strong>kwargs_params</strong> – keyword arguments of the parameters of the model components (e.g. ‘kwargs_lens’ etc)</p></li>
<li><p><strong>num_iter</strong> – number of iterations in the PSF fitting and image fitting process</p></li>
<li><p><strong>keep_psf_error_map</strong> – boolean, if True keeps previous psf_error_map</p></li>
<li><p><strong>no_break</strong> – boolean, if True, runs until the end regardless of the next step getting worse, and then
reads out the overall best fit</p></li>
<li><p><strong>verbose</strong> – print statements informing about progress of iterative procedure</p></li>
<li><p><strong>kwargs_psf_update</strong> – keyword arguments providing the settings for a single iteration of the PSF, as being
passed to update_psf() method</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>keyword argument of PSF constructor for PSF() class with updated PSF</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lenstronomy.Workflow.psf_fitting.PsfFitting.update_psf">
<code class="sig-name descname">update_psf</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">kwargs_psf</span></em>, <em class="sig-param"><span class="n">kwargs_params</span></em>, <em class="sig-param"><span class="n">stacking_method</span><span class="o">=</span><span class="default_value">'median'</span></em>, <em class="sig-param"><span class="n">psf_symmetry</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">psf_iter_factor</span><span class="o">=</span><span class="default_value">0.2</span></em>, <em class="sig-param"><span class="n">block_center_neighbour</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">error_map_radius</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">block_center_neighbour_error_map</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">new_procedure</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/Workflow/psf_fitting.html#PsfFitting.update_psf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lenstronomy.Workflow.psf_fitting.PsfFitting.update_psf" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kwargs_psf</strong> – keyword arguments to construct the PSF() class</p></li>
<li><p><strong>kwargs_params</strong> – keyword arguments of the parameters of the model components (e.g. ‘kwargs_lens’ etc)</p></li>
<li><p><strong>stacking_method</strong> – ‘median’, ‘mean’; the different estimates of the PSF are stacked and combined together.
The choices are:
‘mean’: mean of pixel values as the estimator (not robust to outliers)
‘median’: median of pixel values as the estimator (outlier rejection robust but needs &gt;2 point sources in the data</p></li>
<li><p><strong>psf_symmetry</strong> – number of rotational invariant symmetries in the estimated PSF.
=1 mean no additional symmetries. =4 means 90 deg symmetry. This is enforced by a rotatioanl stack according to
the symmetry specified. These additional imposed symmetries can help stabelize the PSF estimate when there are
limited constraints/number of point sources in the image.</p></li>
<li><p><strong>psf_iter_factor</strong> – factor in (0, 1] of ratio of old vs new PSF in the update in the iteration.</p></li>
<li><p><strong>block_center_neighbour</strong> – angle, radius of neighbouring point sources around their centers the estimates
is ignored. Default is zero, meaning a not optimal subtraction of the neighbouring point sources might
contaminate the estimate.</p></li>
<li><p><strong>block_center_neighbour_error_map</strong> – angle, radius of neighbouring point sources around their centers the
estimates of the ERROR MAP is ignored. If None, then the value of block_center_neighbour is used (recommended)</p></li>
<li><p><strong>error_map_radius</strong> – float, radius (in arc seconds) of the outermost error in the PSF estimate
(e.g. to avoid double counting of overlapping PSF errors), if None, all of the pixels are considered
(unless blocked through other means)</p></li>
<li><p><strong>new_procedure</strong> – boolean, uses post lenstronomy 1.9.2 procedure which is more optimal for super-sampled PSF’s</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>kwargs_psf_new, logL_after, error_map</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-lenstronomy.Workflow.update_manager">
<span id="lenstronomy-workflow-update-manager-module"></span><h2>lenstronomy.Workflow.update_manager module<a class="headerlink" href="#module-lenstronomy.Workflow.update_manager" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="lenstronomy.Workflow.update_manager.UpdateManager">
<em class="property">class </em><code class="sig-prename descclassname">lenstronomy.Workflow.update_manager.</code><code class="sig-name descname">UpdateManager</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">kwargs_model</span></em>, <em class="sig-param"><span class="n">kwargs_constraints</span></em>, <em class="sig-param"><span class="n">kwargs_likelihood</span></em>, <em class="sig-param"><span class="n">kwargs_params</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/Workflow/update_manager.html#UpdateManager"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lenstronomy.Workflow.update_manager.UpdateManager" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>this class manages the parameter constraints as they may evolve through the steps of the modeling.
This includes: keeping certain parameters fixed during one modelling step</p>
<dl class="py method">
<dt id="lenstronomy.Workflow.update_manager.UpdateManager.best_fit">
<code class="sig-name descname">best_fit</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">bijective</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/Workflow/update_manager.html#UpdateManager.best_fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lenstronomy.Workflow.update_manager.UpdateManager.best_fit" title="Permalink to this definition">¶</a></dt>
<dd><p>best fit (max likelihood) position for all the model parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>bijective</strong> – boolean, if True, returns the parameters in the argument of the sampling that might deviate
from the convention of the ImSim module. For example, if parameterized in the image position, the parameters
remain in the image plane rather than being mapped to the source plane.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>kwargs_result with all the keyword arguments of the best fit for the model components</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lenstronomy.Workflow.update_manager.UpdateManager.fix_image_parameters">
<code class="sig-name descname">fix_image_parameters</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">image_index</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/Workflow/update_manager.html#UpdateManager.fix_image_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lenstronomy.Workflow.update_manager.UpdateManager.fix_image_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>fixes all parameters that are only assigned to a specific image. This allows to sample only parameters that
constraint by the fitting of a sub-set of the images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>image_index</strong> – index</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lenstronomy.Workflow.update_manager.UpdateManager.fixed_kwargs">
<em class="property">property </em><code class="sig-name descname">fixed_kwargs</code><a class="headerlink" href="#lenstronomy.Workflow.update_manager.UpdateManager.fixed_kwargs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="lenstronomy.Workflow.update_manager.UpdateManager.init_kwargs">
<em class="property">property </em><code class="sig-name descname">init_kwargs</code><a class="headerlink" href="#lenstronomy.Workflow.update_manager.UpdateManager.init_kwargs" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>keyword arguments for all model components of the initial mean model proposition in the sampling</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lenstronomy.Workflow.update_manager.UpdateManager.param_class">
<em class="property">property </em><code class="sig-name descname">param_class</code><a class="headerlink" href="#lenstronomy.Workflow.update_manager.UpdateManager.param_class" title="Permalink to this definition">¶</a></dt>
<dd><p>creating instance of lenstronomy Param() class. It uses the keyword arguments in self.kwargs_constraints as
__init__() arguments, as well as self.kwargs_model, and the set of kwargs_fixed___, kwargs_lower___,
kwargs_upper___ arguments for lens, lens_light, source, point source, extinction and special parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>instance of the Param class with the recent options and bounds</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lenstronomy.Workflow.update_manager.UpdateManager.parameter_state">
<em class="property">property </em><code class="sig-name descname">parameter_state</code><a class="headerlink" href="#lenstronomy.Workflow.update_manager.UpdateManager.parameter_state" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>parameter state saved in this class</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lenstronomy.Workflow.update_manager.UpdateManager.set_init_state">
<code class="sig-name descname">set_init_state</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/Workflow/update_manager.html#UpdateManager.set_init_state"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lenstronomy.Workflow.update_manager.UpdateManager.set_init_state" title="Permalink to this definition">¶</a></dt>
<dd><p>set the current state of the parameters to the initial one.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lenstronomy.Workflow.update_manager.UpdateManager.sigma_kwargs">
<em class="property">property </em><code class="sig-name descname">sigma_kwargs</code><a class="headerlink" href="#lenstronomy.Workflow.update_manager.UpdateManager.sigma_kwargs" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>keyword arguments for all model components of the initial 1-sigma width proposition in the sampling</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lenstronomy.Workflow.update_manager.UpdateManager.update_fixed">
<code class="sig-name descname">update_fixed</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lens_add_fixed</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">source_add_fixed</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">lens_light_add_fixed</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">ps_add_fixed</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">special_add_fixed</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">lens_remove_fixed</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">source_remove_fixed</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">lens_light_remove_fixed</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">ps_remove_fixed</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">special_remove_fixed</span><span class="o">=</span><span class="default_value">[]</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/Workflow/update_manager.html#UpdateManager.update_fixed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lenstronomy.Workflow.update_manager.UpdateManager.update_fixed" title="Permalink to this definition">¶</a></dt>
<dd><p>adds or removes the values of the keyword arguments that are stated in the _add_fixed to the existing fixed
arguments. convention for input arguments are:
[[i_model, [‘param_name1’, ‘param_name2’, …], [value1, value2, … (optional)], [], …]</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lens_add_fixed</strong> – added fixed parameter in lens model</p></li>
<li><p><strong>source_add_fixed</strong> – added fixed parameter in source model</p></li>
<li><p><strong>lens_light_add_fixed</strong> – added fixed parameter in lens light model</p></li>
<li><p><strong>ps_add_fixed</strong> – added fixed parameter in point source model</p></li>
<li><p><strong>special_add_fixed</strong> – added fixed parameter in special model</p></li>
<li><p><strong>lens_remove_fixed</strong> – remove fixed parameter in lens model</p></li>
<li><p><strong>source_remove_fixed</strong> – remove fixed parameter in source model</p></li>
<li><p><strong>lens_light_remove_fixed</strong> – remove fixed parameter in lens light model</p></li>
<li><p><strong>ps_remove_fixed</strong> – remove fixed parameter in point source model</p></li>
<li><p><strong>special_remove_fixed</strong> – remove fixed parameter in special model</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>updated kwargs fixed</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lenstronomy.Workflow.update_manager.UpdateManager.update_limits">
<code class="sig-name descname">update_limits</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">change_source_lower_limit</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">change_source_upper_limit</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">change_lens_lower_limit</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">change_lens_upper_limit</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/Workflow/update_manager.html#UpdateManager.update_limits"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lenstronomy.Workflow.update_manager.UpdateManager.update_limits" title="Permalink to this definition">¶</a></dt>
<dd><p>updates the limits (lower and upper) of the update manager instance</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>change_source_lower_limit</strong> – [[i_model, [‘param_name’, …], [value1, value2, …]]]</p></li>
<li><p><strong>change_lens_lower_limit</strong> – [[i_model, [‘param_name’, …], [value1, value2, …]]]</p></li>
<li><p><strong>change_source_upper_limit</strong> – [[i_model, [‘param_name’, …], [value1, value2, …]]]</p></li>
<li><p><strong>change_lens_upper_limit</strong> – [[i_model, [‘param_name’, …], [value1, value2, …]]]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>updates internal state of lower and upper limits accessible from outside</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lenstronomy.Workflow.update_manager.UpdateManager.update_options">
<code class="sig-name descname">update_options</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">kwargs_model</span></em>, <em class="sig-param"><span class="n">kwargs_constraints</span></em>, <em class="sig-param"><span class="n">kwargs_likelihood</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/Workflow/update_manager.html#UpdateManager.update_options"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lenstronomy.Workflow.update_manager.UpdateManager.update_options" title="Permalink to this definition">¶</a></dt>
<dd><p>updates the options by overwriting the kwargs with the new ones being added/changed
WARNING: some updates may not be valid depending on the model options. Use carefully!</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kwargs_model</strong> – keyword arguments to describe all model components used in
class_creator.create_class_instances() that are updated from previous arguments</p></li>
<li><p><strong>kwargs_constraints</strong> – </p></li>
<li><p><strong>kwargs_likelihood</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>kwargs_model, kwargs_constraints, kwargs_likelihood</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lenstronomy.Workflow.update_manager.UpdateManager.update_param_state">
<code class="sig-name descname">update_param_state</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">kwargs_lens</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">kwargs_source</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">kwargs_lens_light</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">kwargs_ps</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">kwargs_special</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">kwargs_extinction</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/Workflow/update_manager.html#UpdateManager.update_param_state"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lenstronomy.Workflow.update_manager.UpdateManager.update_param_state" title="Permalink to this definition">¶</a></dt>
<dd><p>updates the temporary state of the parameters being saved. ATTENTION: Any previous knowledge gets lost if you
call this function</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kwargs_lens</strong> – </p></li>
<li><p><strong>kwargs_source</strong> – </p></li>
<li><p><strong>kwargs_lens_light</strong> – </p></li>
<li><p><strong>kwargs_ps</strong> – </p></li>
<li><p><strong>kwargs_special</strong> – </p></li>
<li><p><strong>kwargs_extinction</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lenstronomy.Workflow.update_manager.UpdateManager.update_param_value">
<code class="sig-name descname">update_param_value</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lens</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">source</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">lens_light</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">ps</span><span class="o">=</span><span class="default_value">[]</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lenstronomy/Workflow/update_manager.html#UpdateManager.update_param_value"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lenstronomy.Workflow.update_manager.UpdateManager.update_param_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Set a model parameter to a specific value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lens</strong> – [[i_model, [‘param1’, ‘param2’,…], […]]</p></li>
<li><p><strong>source</strong> – [[i_model, [‘param1’, ‘param2’,…], […]]</p></li>
<li><p><strong>lens_light</strong> – [[i_model, [‘param1’, ‘param2’,…], […]]</p></li>
<li><p><strong>ps</strong> – [[i_model, [‘param1’, ‘param2’,…], […]]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>0, the value of the param is overwritten</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-lenstronomy.Workflow">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-lenstronomy.Workflow" title="Permalink to this headline">¶</a></h2>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">lenstronomy.Workflow package</a><ul>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-lenstronomy.Workflow.alignment_matching">lenstronomy.Workflow.alignment_matching module</a></li>
<li><a class="reference internal" href="#module-lenstronomy.Workflow.fitting_sequence">lenstronomy.Workflow.fitting_sequence module</a></li>
<li><a class="reference internal" href="#module-lenstronomy.Workflow.psf_fitting">lenstronomy.Workflow.psf_fitting module</a></li>
<li><a class="reference internal" href="#module-lenstronomy.Workflow.update_manager">lenstronomy.Workflow.update_manager module</a></li>
<li><a class="reference internal" href="#module-lenstronomy.Workflow">Module contents</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="lenstronomy.Util.html"
                        title="previous chapter">lenstronomy.Util package</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="contributing.html"
                        title="next chapter">Contributing to lenstronomy</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/lenstronomy.Workflow.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="contributing.html" title="Contributing to lenstronomy"
             >next</a> |</li>
        <li class="right" >
          <a href="lenstronomy.Util.html" title="lenstronomy.Util package"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">lenstronomy 1.9.3 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="lenstronomy.html" >lenstronomy package</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">lenstronomy.Workflow package</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, Simon Birrer and contributors.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.4.2.
    </div>
  </body>
</html>